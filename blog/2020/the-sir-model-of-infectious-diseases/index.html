<!DOCTYPE html>
<html lang="en">
<head>

  <!-- https://github.com/joshbuchea/HEAD -->

  <!-- Recommended -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Elements -->
  <meta charset="utf-8">

  <!-- Meta -->
  <meta name="description" content="Windty is a basic template using 11ty and Tailwind, and deploys to github pages.">
  <meta name="generator" content="11ty">

  <!-- Icons -->
  <!-- https://favicon.io/ -->
  <link rel="apple-touch-icon" sizes="180x180" href="/jrekier.github.io/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/jrekier.github.io/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/jrekier.github.io/favicon-16x16.png">
  <link rel="manifest" href="/jrekier.github.io/site.webmanifest">


  <title>The SIR model of infectious diseases</title>

  <link rel="stylesheet" href="/site.css">
  
  <link href="/prism-theme.css" rel="stylesheet">
  

  <style>
    .MathJax {
      min-width: 0;
      padding:0.25em;
      overflow-x:auto;
      overflow-y: hidden;
    }
  </style>
  <script>
    MathJax = {
      loader: {load: ['[tex]/bussproofs']},
      tex: {
        packages: {'[+]': ['bussproofs']},        // extensions to use
        inlineMath: [ ['$','$'], ['\\(','\\)'] ],  // start/end delimiter pairs for in-line math
        processEscapes: true,      // use \$ to produce a literal dollar sign
        processEnvironments: true, // process \begin{xxx}...\end{xxx} outside math mode
        processRefs: true,         // process \ref{...} outside of math mode
        tags: 'all'              // or 'none' or 'ams'        
      }
    };
  </script>  
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
</head>

<body class="font-sans leading-normal tracking-normal text-gray-900">
  <div>
    
<header>
  <nav id="navbar" class="shadow-none z-50 w-full bg-white overflow-hidden sm:flex sm:justify-between sm:items-center sm:px-4 sm:py-2">
  
  
  
  <div class="flex z-10 items-center justify-between px-4 py-2 sm:p-0">
    <div> 
      <a href="/" class="flex relative items-center justify-between font-semibold hover:text-red-700">
        <img class="h-12" src="/images/geology.svg" alt="Logo"/>
        <p class="px-2 py-2 font-serif">Globally Warm</p>
      </a>
    </div>
    <div class="sm:hidden relative"> 
      <button @click="isOpen = !isOpen" type="button" class="block hover:text-red-700 focus:outline-none">
        <svg class="h-6 w-6 fill-current" viewBox="0 0 24 24">
          <path v-if="isOpen" fill-rule="evenodd" d="M18.278 16.864a1 1 0 0 1-1.414 1.414l-4.829-4.828-4.828 4.828a1 1 0 0 1-1.414-1.414l4.828-4.829-4.828-4.828a1 1 0 0 1 1.414-1.414l4.829 4.828 4.828-4.828a1 1 0 1 1 1.414 1.414l-4.828 4.829 4.828 4.828z"/>
          <path v-if="!isOpen" fill-rule="evenodd" d="M4 5h16a1 1 0 0 1 0 2H4a1 1 0 1 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2zm0 6h16a1 1 0 0 1 0 2H4a1 1 0 0 1 0-2z"/>
        </svg>
      </button>
    </div>
  </div>
  
  <div :class="[isOpen ? 'block' : 'hidden']" class="relative px-2 py-2 sm:flex sm:p-0 text-center">
    
      <a href="/blog"class="block sm:inline-block px-2 py-1 font-serif hover:text-red-700 sm:mt-0 sm:ml-2">Blog</a>
    
      <a href="/quartz"class="block sm:inline-block px-2 py-1 font-serif hover:text-red-700 sm:mt-0 sm:ml-2">Notes</a>
    
      <a href="/about"class="block sm:inline-block px-2 py-1 font-serif hover:text-red-700 sm:mt-0 sm:ml-2">About</a>
    
  </div>
</nav>
</header>


<div class="container flex flex-cols-8 gap-4">

  <!-- Sidebar Section -->
  
  <aside class="hidden md:hidden lg:col-span-2 lg:flex flex-col items-center px-3 md:py-4 h-screen sticky top-0">

    
    <div class="flex flex-col my-4 p-6">
      <p class="font-serif text-xl mb-2">
        The SIR model of infectious diseases
      </p>
      <p href="#" class="text-sm text-gray-700">
        28 Mar 2020
      </p>
      <a href="/about/" class="flex relative items-center py-4">
        <img class="w-12 h-12 rounded-full inline-flex items-center" src="/images/bio-photo.jpg" alt="Buster"/>
        <p class="px-4 py-2 font-bold text-sm">jerem.</p>
      </a>
      
      <div class="px-2 py-4">
        
        <a href="/tags/math"><span class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm text-gray-700 hover:text-red-700 mr-2">#math</span></a>
        
        <a href="/tags/ecology"><span class="inline-block bg-gray-200 rounded-full px-3 py-1 text-sm text-gray-700 hover:text-red-700 mr-2">#ecology</span></a>
        
      </div>    
    </div>

  </aside>

  <!-- Post Section -->
  
  <section class="container col-span-8 lg:col-span-6 lg:flex flex-col items-center px-3 py-4">  

    
    <article class="flex flex-col my-4">
      <div class="bg-white flex flex-col justify-start pb-4">
        
        <a href="#" class="text-red-700 text-sm font-bold uppercase pb-4">blog</a>
        <a href="#" class="text-3xl font-serif hover:text-red-700">The SIR model of infectious diseases</a>
      </div>
      <p href="#" class="flex lg:hidden text-sm text-gray-700 pb-4">
        March 28, 2020
      </p>
      <a href="/about/" class="flex lg:hidden relative items-center pb-4">
        <img class="w-12 h-12 rounded-full inline-flex items-center" src="/images/bio-photo.jpg" alt="Buster"/>
        <p class="px-4 py-2 font-bold text-sm">jerem.</p>
      </a>
      <div class="text-gray-900 font-semibold text-lg lg:text-xl pt-4 pb-4">
        Reacting to the actuality of the coronavirus pandemic that we are currently living through, I present some simplified mathematical models used in epidemiology.
      </div>
      <!-- Article Image -->
      
      <div class="text-center relative block max-h-64 overflow-hidden mb-4 pt-4">
        <img alt="content" class="w-full rounded-lg object-cover" src="/images/posts_data/epidemiology-model/compartments.svg">
        
      </div>
      

      <div class="markdown font-serif">
        <p>We are currently living through the coronavirus crisis (covid-19). A lot of people have tried to share a little insight on the mechanisms at play in the control of the epidemic and their mathematical modelling. Here, I would like to share a few things I have learnt recently on the subject. I want to insist that I am not an expert in epidemiology and so I do not recommend to use anything that follows as a basis of any decision. I merely want to outline the very broad principles involved in the mathematical modelling of epidemics.</p>
<p>I will focus specifically on the simple SIS and SIR models. This is based on the resolution of non-linear differential equations giving the proportion of people in a population that have been infected by the disease, $i(t)$, those who have not, $s(t)$ and those who have been infected but recovered $r(t)$. Let us assume first that the people who have been infected do not develop long-lasting immunity after they are cured. This implies that the recovered people count as susceptible people. Hence the total number of people are distributed among two compartments $s\leftrightarrow i$ . The equations are then:</p>
<p>$$<br>
\begin{align}<br>
\frac{ds}{dt}&amp;=-\beta si+\gamma i~,\label{eq:dsdtSIS}\\<br>
\frac{di}{dt}&amp;=+\beta si-\gamma i~.\label{eq:didtSIS}<br>
\end{align}<br>
$$</p>
<p>In a <a href="/blog/2020/what-growth-means">previous post</a> about exponential growth, we have seen how differential equations like those above define a relationship between functions and their rates of change. The situation here follows the same logic, except that there are now two functions rather than one. The first term of the right-hand side of each equation expresses the fact that the fraction of new infected patients is proportional to the number of persons already infected and to the number of persons that are not and so are susceptible to be. The last term of each equation takes into account the fraction of the infected people that become healthy again. The values of the two real parameters, $\beta$ and $\gamma$ dictates the behaviour of the epidemic. This is perhaps better understood by combining the Eq. \eqref{eq:dsdtSIS} and \eqref{eq:didtSIS} into a single one. In order to do so, we must first realize that the two add up to zero, so that the total number of people remains constant at all time:</p>
<p>$$<br>
\begin{align}<br>
\frac{d}{dt}(s+i)&amp;=0~,\\<br>
\leftrightarrow s+i&amp;=k~.\label{eq:s+i=k}<br>
\end{align}<br>
$$</p>
<p>It is convenient to set the constant $k=1$ so that $s$ and $i$ are numbers between $0$ and $1$. Reinjecting Eq. \eqref{eq:s+i=k} into Eq. \eqref{eq:didtSIS} we arrive at :</p>
<p>$$<br>
\frac{di}{dt}=(\beta-\gamma)i-\beta i^2~.<br>
$$</p>
<p>This is a particular example of the <a href="https://en.wikipedia.org/wiki/Logistic_function#Logistic_differential_equation">logistic differential equation</a>. If we ignore the second term on the right-hand side for a moment and compare what remains with our <a href="/blog/2020/what-growth-means">well-known equation for the exponential growth</a>, we can identify the combination $(\beta-\gamma)$ as the growth rate. There are two possible behaviours: either $\beta&gt;\gamma$ and so the solution grows exponentially, or $\beta&lt;\gamma$ and the solution decays exponentially in time. Either of those two behaviours dominates when $i$ is small. When $i$ approaches $1$, the decaying effect of the second term kicks in and dominates over the first term. The two behaviours are represented on the following figure.</p>
<figure><img src="/images/posts_data/epidemiology-model/SIS2.png" alt="SIS"></figure>
<p>The area in orange represents the fraction of <em>infected</em> people in the population over time and the area in blue represent the fraction of the population that are not infected and are <em>susceptible</em> to be. In both cases, the fraction of infected people starts at $i_0=1%$. On the left plot, the number of infected decays very rapidly from the start so that the blue area clearly dominates at all time. On the right plot, the number of infected people grows very rapidly at first and then reaches a kind of equilibrium between the patients that are susceptible and those that are infected. This equilibrium happens when the flux of newly infected people is equal to the flux of people that become cured, <em>i.e.</em> when $\beta is=\gamma i$, or equivalently:</p>
<p>$$<br>
\beta =\frac{\gamma}{s}\leftrightarrow R_0=\frac{1}{s}~,<br>
$$</p>
<p>where we have defined $R_0\equiv\frac{\beta}{\gamma}$ . This last parameter is known as the <a href="https://en.wikipedia.org/wiki/Basic_reproduction_number">basic reproduction number</a> and is one of the most fundamental quantities in epidemiology as we will see shortly.</p>
<p>Having considered the simple SIS model in some details, we are now ready to tackle the more sophisticated SIR model. This differs to what precedes in the fact that now we have to look at three equations governing the dynamics of the population between three compartments:</p>
<p>$$<br>
\begin{align}<br>
\frac{ds}{dt}&amp;=-\beta si~\label{eq:dsdtSIR}\\<br>
\frac{di}{dt}&amp;=+\beta si-\gamma i~,\label{eq:didtSIR}\\<br>
\frac{dr}{dt}&amp;=+\gamma i~.\label{eq:drdtSIR}<br>
\end{align}<br>
$$</p>
<p>The major difference with Eqs. \eqref{eq:dsdtSIS} and \eqref{eq:didtSIS} is that, now, people that have been infected and then cured, do not go back to the group of susceptible people but rather populate the set of <em>recovered</em> people. Because $\beta$, $\gamma$, $s$ and $i$ are all positive numbers, Eq. \eqref{eq:s+i=k} tells us that the fraction of the recovered can only go up in time while the fraction of the susceptible always goes down.The relation between the compartments can be summarized by  $s\rightarrow i \rightarrow r$. Contrary to the SIS model, there is no way to reduce the dynamics to a single equation. The best we can do is to use $s+i+r=1$ to write Eqs. \eqref{eq:dsdtSIS} and \eqref{eq:didtSIS} in the following form:</p>
<p>$$<br>
\begin{align}<br>
\frac{ds}{dt}&amp;=-R_0\gamma si~,\\<br>
\frac{di}{dt}&amp;=(R_0 s-1)\gamma i~,<br>
\end{align}<br>
$$</p>
<p>where we have inserted the definition of $R_0$. The value of this quantity at the beginning of the epidemic determines its dynamics, as we can see on the following figure:</p>
<p><img src="/images/posts_data/epidemiology-model/SIR2.png" alt="SIR">{: .align-center}</p>
<p>On the left, we can see the situation when $R_0=\frac{0.1}{s_0}$, where $s_0$ represents the fraction of susceptible patients at initial time.  In such case the people that are infected quickly recover, after what they cease to be infection and the number of cases remains small. The situation on the right is quite different. In that case, we have $R_0=\frac{10}{s_0}$, which means that people become infected more quickly than they recover and we end up with a proper epidemic. The threshold between those two regimes corresponds to $R_0=\frac{1}{s_0}$.</p>
<p>At the moment of writing this note, we are in the middle of a global epidemic of covid-19. A recent estimate heard on the radio mentions that half of the worldwide population lives currently isolated. We are obviously faced with a very infectious disease. We can sometimes see on the news that the isolation measures aim to <em>flatten the curve</em>. This statement can be understood by considering the effect that isolation has on the value of $R_0$. We have seen that this parameter depends on both $\beta$ and $\gamma$. The latter of which represents the rapidity with which people recover from the illness. It is perhaps easier to understand if we identify $\tau_R=\gamma^{-1}$ as the typical time before recovery. It is typically very difficult to influence this parameter except by significantly improving the care provided to patients or by inventing a new drug or vaccine. At any rate, such changes in $\gamma$ usually take a lot of time. It is more straightforward to influence the value of $\tau_C=\beta^{-1}$ which represents the typical time between transmissions of the virus from one infected to one susceptible person. Having people stay at home increases this time of contact and thus reduces $\beta$ and so $R_0$. The effect can be seen on the following animated figure.</p>
<figure><img src="/images/posts_data/epidemiology-model/SIR2.gif" alt="SIR"></figure>
<p>We can see that the peak of the epidemic gets lower and lower as $\beta$ decreases. There are clearly two scenarios possible. If we manage to keep the curve very flat, the percentage of the population that is infected remains relatively small at all time. It can even be so low that most people get through the epidemic without ever being infected. On the other hand, if we are unable to flatten the curve, the number of infected patients can go very high, after what the number of susceptible people approaches zero rapidly indicating that most people have become infected and recovered and so the epidemic dies out. A situation called <em>herd immunity</em>.</p>
<p>Now, it is very important to bear in mind that there are a great deal of aspects that the very simple model above does not take into account. Crucially, by considering the total population as a constant we have always implicitly assumed that you cannot die from the disease regardless of the maximum number of people infected at once. This is obviously not true for an epidemic such as covid-19 which has proved to be very dangerous in many cases so that the survival rate of the population really depends on the capacities of the healthcare system which are obviously finite. Another thing that we did not consider is the possibility that after a short period of immunity following recovery, people become susceptible to become ill again. Such complex dynamics can be accommodated with more sophisticated models of epidemiology.</p>
<p>To conclude this note, I strongly encourage you to have a look at <a href="https://youtu.be/gxAaO2rsdIs">this video</a> if you haven't already. It deals in the SIR model in considerably more details than I did here. Regarding the covid-19 epidemic specifically, I recommend <a href="https://medium.com/@wpegden/a-call-to-honesty-in-pandemic-modeling-5c156686a64b">this note</a> as well as <a href="https://science.sciencemag.org/content/early/2020/03/30/science.abb6936.full">this paper</a> which raises many issues regarding the relevance and the ethical implications of some of the measures that could be implemented to control the epidemic in the long run.</p>

      </div>

    </article>

    
    
    
  </section>



</div>
  </div>
  <script src="/js/navbar.js"></script>
  <!-- footer -->
<footer class="flex justify-center px-4 text-black bg-white font-serif">
  <div class="container py-6">
    <hr class="h-px mt-6 bg-gray-700 border-none">

    <div class="flex flex-col items-center justify-between mt-6 md:mt-0 md:flex-row">
      <div>
        &copy; 2022 <a href="/about" class="hover:text-red-700">Jérémy Rekier.</a>
        <p class="text-xs">Icons by <a href="https://www.flaticon.com/authors/freepik"  class="hover:text-red-700" title="Freepik">Freepik</a> from <a href="https://www.flaticon.com/" class="hover:text-red-700" title="Flaticon"> www.flaticon.com</a></p>
      </div>
      <!-- Social Media Links -->
      <div class="flex justify-center space-x-4 mt-4"> <!-- Added top margin -->
        <a href="https://mathstodon.xyz/@jrekier" class="text-sm">
          <img class="h-6" src="/images/socialmedia/051-mastodon.svg" alt="Mastodon">
        </a>
        <a href="https://bsky.app/profile/jrekier.bsky.social" class="text-sm">
          <img class="h-6" src="/images/socialmedia/052-bluesky.svg" alt="Bluesky">
        </a>
        <a href="https://github.com/jrekier" class="text-sm">
          <img class="h-6" src="/images/socialmedia/038-github.svg" alt="GitHub">
        </a>
      </div>
    </div>
  </div>

</footer>
</body>
</html>
